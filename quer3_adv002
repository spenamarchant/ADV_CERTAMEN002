#!/usr/bin/env python
import sys
from collections import defaultdict

data = defaultdict(list)

for line in sys.stdin:
    try:
        query_id, genre, collection, year, pop = line.strip().split('\t')
        if query_id != 'q3': continue
        data[f"{genre}\t{collection}"].append((int(year), float(pop)))
    except:
        continue

results = []
for group, entries in data.items():
    # Sumar popularity por año
    year_sums = defaultdict(float)
    for year, pop in entries:
        year_sums[year] += pop
    # Ordenar por año para LAG
    sorted_years = sorted(year_sums.items(), key=lambda x: x[0])
    prev_pop = None
    for year, total_pop in sorted_years:
        if prev_pop is not None and prev_pop > 0:
            growth = (total_pop - prev_pop) / prev_pop * 100
            results.append((growth, group, year, total_pop))
        prev_pop = total_pop

results.sort(reverse=True)
for growth, group, year, total_pop in results[:10]:
    genre, collection = group.split('\t')
    print(f"{genre}\t{collection}\t{year}\t{total_pop:.2f}\t{growth:.2f}")
