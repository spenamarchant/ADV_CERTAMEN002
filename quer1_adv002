#!/usr/bin/env python
import sys
import math
from collections import defaultdict

# Agrupar por compañía para contar películas
company_counts = defaultdict(int)
company_data = defaultdict(list)

for line in sys.stdin:
    try:
        query_id, company, status, vote_avg = line.strip().split('\t')
        if query_id != 'q1': continue
        company_counts[company] += 1
        company_data[(company, status)].append(float(vote_avg))
    except:
        continue

# Procesar datos para compañías con >1 película
results = []
for (company, status), votes in company_data.items():
    if company_counts[company] > 1:
        n = len(votes)
        avg = sum(votes) / n
        variance = sum((x - avg) ** 2 for x in votes) / n
        stddev = math.sqrt(variance) if variance > 0 else 0
        if stddev > 0.5:
            results.append((stddev, company, status, avg))

# Ordenar y limitar a 10
results.sort(reverse=True)
for stddev, company, status, avg in results[:10]:
    print(f"{company}\t{status}\t{stddev:.2f}\t{avg:.2f}")
